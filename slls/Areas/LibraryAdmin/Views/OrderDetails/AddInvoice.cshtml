@using slls.Models
@using VortexSoft.Bootstrap
@using Westwind.Globalization
@model slls.ViewModels.OrderDetailsEditViewModel

@Html.Partial("_HeaderSeeAlso", Model)

<div class="well">
    @Html.Partial("_Select")
    <a href="@Url.Action("Create", "OrderDetails", new {id = ViewData["CopyID"]})" class="btn btn-primary" data-toggle="modal" data-target="#lrgModal" title="Add New @DbRes.T("Orders.Order", "FieldDisplayName")"><span aria-hidden="true" class="glyphicon glyphicon-plus-sign"></span> Add New @DbRes.T("Orders.Order", "FieldDisplayName")</a>
    <a href="@Url.Action("DuplicateOrder", "OrderDetails", new {id = Model.OrderID})" class="btn btn-primary" title="Duplicate @DbRes.T("Orders.Order", "FieldDisplayName")"><span aria-hidden="true" class="glyphicon glyphicon-duplicate"></span> Duplicate @DbRes.T("Orders.Order", "FieldDisplayName")</a>
</div>

@Html.Partial("_PostSuccess")

@if (Model.WarningMsg.Length > 0)
{
    <div class="alert alert-warning alert-dismissable" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <span class="sr-only">Message:</span>
        @Html.Raw(Model.WarningMsg)
    </div>
}

@using (Html.BeginForm("Update", "OrderDetails", FormMethod.Post))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    @Html.HiddenFor(model => model.OrderID)
    @Html.HiddenFor(model => model.SelectedTab)
    @Html.HiddenFor(model => model.CallingAction)

    @Html.Partial("_OrderDetails", Model)

    <div class="form-footer">
        <span class="pull-left">
            <a href="@Url.Action("Delete", new {id = Model.OrderID})" class="btn btn-danger modal-link" title="Delete Order"><span aria-hidden="true" class="glyphicon glyphicon-trash"></span> Delete Order</a>
        </span>
        <button type="submit" id="btnSave" value="Save" class="btn btn-success"><span aria-hidden="true" class="glyphicon glyphicon-ok"></span> @DbRes.T("Buttons.Confirm_Update", "Terminology")</button>
        &nbsp;&nbsp;or&nbsp;<input type="button" value="Cancel" class="btn-link" onclick="window.history.back();" />
    </div>
}

<script type="text/javascript">

    $(document).ready(function () {
        //REM: go to the required tab, if it exists ...
        var goToTab = "@Model.SelectedTab";
        $('#orderTabs a[href="'+ goToTab + '"]').tab('show'); // Select tab by name

        //REM: Hide the 'success' alert after x seconds ...
        setTimeout(function () {
            $(".alert-success").alert('close');
        }, 6000);
    });
    
</script>
